{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 0.0, "shaped_reward_min": 0, "shaped_reward_max": 0, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.0, "onion_pickup_agent_0_min": 5, "onion_pickup_agent_0_max": 7, "onion_pickup_agent_1_mean": 3.5, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 5, "useful_onion_pickup_agent_0_mean": 6.0, "useful_onion_pickup_agent_0_min": 5, "useful_onion_pickup_agent_0_max": 7, "useful_onion_pickup_agent_1_mean": 3.5, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 5, "onion_drop_agent_0_mean": 5.0, "onion_drop_agent_0_min": 4, "onion_drop_agent_0_max": 6, "onion_drop_agent_1_mean": 3.0, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 4, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 0, "potting_onion_agent_1_mean": 0.0, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 0, "dish_pickup_agent_0_mean": 0.5, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 1, "dish_pickup_agent_1_mean": 3.5, "dish_pickup_agent_1_min": 3, "dish_pickup_agent_1_max": 4, "useful_dish_pickup_agent_0_mean": 0.0, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 0, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 0.5, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 1, "dish_drop_agent_1_mean": 3.0, "dish_drop_agent_1_min": 2, "dish_drop_agent_1_max": 4, "useful_dish_drop_agent_0_mean": 0.5, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 1, "useful_dish_drop_agent_1_mean": 2.0, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 0, "optimal_onion_potting_agent_1_mean": 0.0, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 0, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 0, "viable_onion_potting_agent_1_mean": 0.0, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 0, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.15600000321865082, "cur_lr": 0.00015999999595806003, "total_loss": -0.3582386374473572, "policy_loss": -0.00021215900778770447, "vf_loss": 0.00017498157103545964, "vf_explained_var": 0.5578588247299194, "kl": 1.2560765753732994e-05, "entropy": 1.7901501655578613, "entropy_coeff": 0.20000000298023224, "model": {}}}}, "num_env_steps_sampled": 800, "num_env_steps_trained": 800, "num_agent_steps_sampled": 1600, "num_agent_steps_trained": 1600}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 0.0}, "policy_reward_mean": {"ppo": 0.0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 0.0, "shaped_reward_min": 0, "shaped_reward_max": 0, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.0, "onion_pickup_agent_0_min": 5, "onion_pickup_agent_0_max": 7, "onion_pickup_agent_1_mean": 3.5, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 5, "useful_onion_pickup_agent_0_mean": 6.0, "useful_onion_pickup_agent_0_min": 5, "useful_onion_pickup_agent_0_max": 7, "useful_onion_pickup_agent_1_mean": 3.5, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 5, "onion_drop_agent_0_mean": 5.0, "onion_drop_agent_0_min": 4, "onion_drop_agent_0_max": 6, "onion_drop_agent_1_mean": 3.0, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 4, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 0, "potting_onion_agent_1_mean": 0.0, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 0, "dish_pickup_agent_0_mean": 0.5, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 1, "dish_pickup_agent_1_mean": 3.5, "dish_pickup_agent_1_min": 3, "dish_pickup_agent_1_max": 4, "useful_dish_pickup_agent_0_mean": 0.0, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 0, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 0.5, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 1, "dish_drop_agent_1_mean": 3.0, "dish_drop_agent_1_min": 2, "dish_drop_agent_1_max": 4, "useful_dish_drop_agent_0_mean": 0.5, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 1, "useful_dish_drop_agent_1_mean": 2.0, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 0, "optimal_onion_potting_agent_1_mean": 0.0, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 0, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 0, "viable_onion_potting_agent_1_mean": 0.0, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 0, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0], "episode_lengths": [400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47440956952863206, "mean_inference_ms": 0.7792211827494557, "mean_action_processing_ms": 0.07049460660786998, "mean_env_wait_ms": 0.38775095618573807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 0.0}, "policy_reward_mean": {"ppo": 0.0}, "hist_stats": {"episode_reward": [0.0, 0.0], "episode_lengths": [400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47440956952863206, "mean_inference_ms": 0.7792211827494557, "mean_action_processing_ms": 0.07049460660786998, "mean_env_wait_ms": 0.38775095618573807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 1600, "num_agent_steps_trained": 1600, "num_env_steps_sampled": 800, "num_env_steps_trained": 800, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 800, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 1600, "timers": {"training_iteration_time_ms": 1015.251, "learn_time_ms": 287.75, "learn_throughput": 2780.189, "synch_weights_time_ms": 14.042}, "counters": {"num_env_steps_sampled": 800, "num_env_steps_trained": 800, "num_agent_steps_sampled": 1600, "num_agent_steps_trained": 1600}, "done": false, "episodes_total": 2, "training_iteration": 1, "trial_id": "default", "experiment_id": "fccb36c3133749cb981cab189ff2c427", "date": "2023-06-17_14-00-55", "timestamp": 1687003255, "time_this_iter_s": 1.7329552173614502, "time_total_s": 1.7329552173614502, "pid": 4612, "hostname": "LAPTOP-TER6F2CR", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F0210DA48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F620ADC48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 1.7329552173614502, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 8.835330724716187, "perf": {"cpu_util_percent": 8.233333333333333, "ram_util_percent": 46.300000000000004}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 2.25, "shaped_reward_min": 0, "shaped_reward_max": 6, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.25, "onion_pickup_agent_0_min": 3, "onion_pickup_agent_0_max": 7, "onion_pickup_agent_1_mean": 5.0, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 9, "useful_onion_pickup_agent_0_mean": 5.25, "useful_onion_pickup_agent_0_min": 3, "useful_onion_pickup_agent_0_max": 7, "useful_onion_pickup_agent_1_mean": 5.0, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 9, "onion_drop_agent_0_mean": 4.5, "onion_drop_agent_0_min": 2, "onion_drop_agent_0_max": 6, "onion_drop_agent_1_mean": 4.0, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 7, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 0, "potting_onion_agent_1_mean": 0.75, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 1.5, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 5, "dish_pickup_agent_1_mean": 2.5, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 4, "useful_dish_pickup_agent_0_mean": 0.0, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 0, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 1.5, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 5, "dish_drop_agent_1_mean": 2.25, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 4, "useful_dish_drop_agent_0_mean": 1.5, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.5, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 0, "optimal_onion_potting_agent_1_mean": 0.75, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 0, "viable_onion_potting_agent_1_mean": 0.75, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.07800000160932541, "cur_lr": 0.00015999999595806003, "total_loss": -0.3567935824394226, "policy_loss": -7.541291415691376e-05, "vf_loss": 0.02237866073846817, "vf_explained_var": 0.012300610542297363, "kl": 1.1420986083976459e-05, "entropy": 1.7894108295440674, "entropy_coeff": 0.19946666061878204, "model": {}}}}, "num_env_steps_sampled": 1600, "num_env_steps_trained": 1600, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 3200}, "sampler_results": {"episode_reward_max": 5.99904, "episode_reward_min": 0.0, "episode_reward_mean": 2.24964, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 5.99904}, "policy_reward_mean": {"ppo": 1.12482}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 2.25, "shaped_reward_min": 0, "shaped_reward_max": 6, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.25, "onion_pickup_agent_0_min": 3, "onion_pickup_agent_0_max": 7, "onion_pickup_agent_1_mean": 5.0, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 9, "useful_onion_pickup_agent_0_mean": 5.25, "useful_onion_pickup_agent_0_min": 3, "useful_onion_pickup_agent_0_max": 7, "useful_onion_pickup_agent_1_mean": 5.0, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 9, "onion_drop_agent_0_mean": 4.5, "onion_drop_agent_0_min": 2, "onion_drop_agent_0_max": 6, "onion_drop_agent_1_mean": 4.0, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 7, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 0, "potting_onion_agent_1_mean": 0.75, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 1.5, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 5, "dish_pickup_agent_1_mean": 2.5, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 4, "useful_dish_pickup_agent_0_mean": 0.0, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 0, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 1.5, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 5, "dish_drop_agent_1_mean": 2.25, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 4, "useful_dish_drop_agent_0_mean": 1.5, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.5, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 0, "optimal_onion_potting_agent_1_mean": 0.75, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 0, "viable_onion_potting_agent_1_mean": 0.75, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952], "episode_lengths": [400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4761429139655312, "mean_inference_ms": 0.7576415168921017, "mean_action_processing_ms": 0.07316761460190054, "mean_env_wait_ms": 0.3958875996958549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 5.99904, "episode_reward_min": 0.0, "episode_reward_mean": 2.24964, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 5.99904}, "policy_reward_mean": {"ppo": 1.12482}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952], "episode_lengths": [400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4761429139655312, "mean_inference_ms": 0.7576415168921017, "mean_action_processing_ms": 0.07316761460190054, "mean_env_wait_ms": 0.3958875996958549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 3200, "num_env_steps_sampled": 1600, "num_env_steps_trained": 1600, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 1600, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 3200, "timers": {"training_iteration_time_ms": 903.795, "learn_time_ms": 195.423, "learn_throughput": 4093.684, "synch_weights_time_ms": 8.592}, "counters": {"num_env_steps_sampled": 1600, "num_env_steps_trained": 1600, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 3200}, "done": false, "episodes_total": 4, "training_iteration": 2, "trial_id": "default", "experiment_id": "fccb36c3133749cb981cab189ff2c427", "date": "2023-06-17_14-00-57", "timestamp": 1687003257, "time_this_iter_s": 1.4277353286743164, "time_total_s": 3.1606905460357666, "pid": 4612, "hostname": "LAPTOP-TER6F2CR", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F0210DA48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F620ADC48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 3.1606905460357666, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 8.835330724716187, "perf": {"cpu_util_percent": 3.55, "ram_util_percent": 46.2}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.0, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.5, "onion_pickup_agent_0_min": 3, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 5.333333333333333, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 9, "useful_onion_pickup_agent_0_mean": 5.5, "useful_onion_pickup_agent_0_min": 3, "useful_onion_pickup_agent_0_max": 8, "useful_onion_pickup_agent_1_mean": 5.333333333333333, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 9, "onion_drop_agent_0_mean": 4.0, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 6, "onion_drop_agent_1_mean": 4.5, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 8, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.5, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 1.6666666666666667, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 5, "dish_pickup_agent_1_mean": 2.5, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 5, "useful_dish_pickup_agent_0_mean": 0.16666666666666666, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 1.6666666666666667, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 5, "dish_drop_agent_1_mean": 2.3333333333333335, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 5, "useful_dish_drop_agent_0_mean": 1.3333333333333333, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.1666666666666667, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.5, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.5, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.039000000804662704, "cur_lr": 0.00015999999595806003, "total_loss": -0.35557353496551514, "policy_loss": -0.00024588173255324364, "vf_loss": 0.05240926146507263, "vf_explained_var": -0.005211830139160156, "kl": 5.167171821085503e-06, "entropy": 1.7886234521865845, "entropy_coeff": 0.19893333315849304, "model": {}}}}, "num_env_steps_sampled": 2400, "num_env_steps_trained": 2400, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 4800}, "sampler_results": {"episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 4.99864, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.49932}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.0, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.5, "onion_pickup_agent_0_min": 3, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 5.333333333333333, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 9, "useful_onion_pickup_agent_0_mean": 5.5, "useful_onion_pickup_agent_0_min": 3, "useful_onion_pickup_agent_0_max": 8, "useful_onion_pickup_agent_1_mean": 5.333333333333333, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 9, "onion_drop_agent_0_mean": 4.0, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 6, "onion_drop_agent_1_mean": 4.5, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 8, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.5, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 1.6666666666666667, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 5, "dish_pickup_agent_1_mean": 2.5, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 5, "useful_dish_pickup_agent_0_mean": 0.16666666666666666, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 1.6666666666666667, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 5, "dish_drop_agent_1_mean": 2.3333333333333335, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 5, "useful_dish_drop_agent_0_mean": 1.3333333333333333, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.1666666666666667, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.5, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.5, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616], "episode_lengths": [400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4741482945729066, "mean_inference_ms": 0.7513760716637602, "mean_action_processing_ms": 0.07473956596085034, "mean_env_wait_ms": 0.4017341483659851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 4.99864, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.49932}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616], "episode_lengths": [400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4741482945729066, "mean_inference_ms": 0.7513760716637602, "mean_action_processing_ms": 0.07473956596085034, "mean_env_wait_ms": 0.4017341483659851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 4800, "num_env_steps_sampled": 2400, "num_env_steps_trained": 2400, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 2400, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 4800, "timers": {"training_iteration_time_ms": 870.514, "learn_time_ms": 164.397, "learn_throughput": 4866.274, "synch_weights_time_ms": 6.565}, "counters": {"num_env_steps_sampled": 2400, "num_env_steps_trained": 2400, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 4800}, "done": false, "episodes_total": 6, "training_iteration": 3, "trial_id": "default", "experiment_id": "fccb36c3133749cb981cab189ff2c427", "date": "2023-06-17_14-00-58", "timestamp": 1687003258, "time_this_iter_s": 1.4423587322235107, "time_total_s": 4.603049278259277, "pid": 4612, "hostname": "LAPTOP-TER6F2CR", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F0210DA48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F620ADC48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 4.603049278259277, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 8.835330724716187, "perf": {"cpu_util_percent": 7.35, "ram_util_percent": 46.25}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.25, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.375, "onion_pickup_agent_0_min": 3, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 6.0, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 11, "useful_onion_pickup_agent_0_mean": 5.375, "useful_onion_pickup_agent_0_min": 3, "useful_onion_pickup_agent_0_max": 8, "useful_onion_pickup_agent_1_mean": 6.0, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 11, "onion_drop_agent_0_mean": 4.0, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 6, "onion_drop_agent_1_mean": 4.875, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.875, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.75, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 1.5, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 5, "dish_pickup_agent_1_mean": 2.375, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 5, "useful_dish_pickup_agent_0_mean": 0.125, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 1.375, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 5, "dish_drop_agent_1_mean": 2.25, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 5, "useful_dish_drop_agent_0_mean": 1.125, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.25, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.875, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.75, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.875, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.75, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.019500000402331352, "cur_lr": 0.00015999999595806003, "total_loss": -0.35474759340286255, "policy_loss": -0.0002564806491136551, "vf_loss": 0.02996929921209812, "vf_explained_var": -0.0034582316875457764, "kl": 4.7810463001951575e-06, "entropy": 1.7881593704223633, "entropy_coeff": 0.19840000569820404, "model": {}}}}, "num_env_steps_sampled": 3200, "num_env_steps_trained": 3200, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 6400}, "sampler_results": {"episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.248259999999999, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.62413}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.25, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.375, "onion_pickup_agent_0_min": 3, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 6.0, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 11, "useful_onion_pickup_agent_0_mean": 5.375, "useful_onion_pickup_agent_0_min": 3, "useful_onion_pickup_agent_0_max": 8, "useful_onion_pickup_agent_1_mean": 6.0, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 11, "onion_drop_agent_0_mean": 4.0, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 6, "onion_drop_agent_1_mean": 4.875, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.875, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.75, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 1.5, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 5, "dish_pickup_agent_1_mean": 2.375, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 5, "useful_dish_pickup_agent_0_mean": 0.125, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 1.375, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 5, "dish_drop_agent_1_mean": 2.25, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 5, "useful_dish_drop_agent_0_mean": 1.125, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.25, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.875, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.75, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.875, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.75, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47184679342772273, "mean_inference_ms": 0.747860888286277, "mean_action_processing_ms": 0.07540097956010822, "mean_env_wait_ms": 0.4034341194527994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.248259999999999, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.62413}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47184679342772273, "mean_inference_ms": 0.747860888286277, "mean_action_processing_ms": 0.07540097956010822, "mean_env_wait_ms": 0.4034341194527994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 6400, "num_env_steps_sampled": 3200, "num_env_steps_trained": 3200, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 3200, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 6400, "timers": {"training_iteration_time_ms": 847.252, "learn_time_ms": 148.318, "learn_throughput": 5393.812, "synch_weights_time_ms": 5.427}, "counters": {"num_env_steps_sampled": 3200, "num_env_steps_trained": 3200, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 6400}, "done": false, "episodes_total": 8, "training_iteration": 4, "trial_id": "default", "experiment_id": "fccb36c3133749cb981cab189ff2c427", "date": "2023-06-17_14-01-00", "timestamp": 1687003260, "time_this_iter_s": 1.492868185043335, "time_total_s": 6.095917463302612, "pid": 4612, "hostname": "LAPTOP-TER6F2CR", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F0210DA48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F620ADC48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 6.095917463302612, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 8.835330724716187, "perf": {"cpu_util_percent": 3.5666666666666664, "ram_util_percent": 46.23333333333333}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 4.5, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.0, "onion_pickup_agent_0_min": 3, "onion_pickup_agent_0_max": 9, "onion_pickup_agent_1_mean": 6.2, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 11, "useful_onion_pickup_agent_0_mean": 6.0, "useful_onion_pickup_agent_0_min": 3, "useful_onion_pickup_agent_0_max": 9, "useful_onion_pickup_agent_1_mean": 6.2, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 11, "onion_drop_agent_0_mean": 4.7, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 8, "onion_drop_agent_1_mean": 5.1, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.7, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 1.3, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 5, "dish_pickup_agent_1_mean": 2.4, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 5, "useful_dish_pickup_agent_0_mean": 0.1, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 1.2, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 5, "dish_drop_agent_1_mean": 2.3, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 5, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.3, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.7, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.7, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.009750000201165676, "cur_lr": 0.00015999999595806003, "total_loss": -0.3536282777786255, "policy_loss": -1.4667399227619171e-05, "vf_loss": 0.007662472780793905, "vf_explained_var": 0.041616231203079224, "kl": 5.940555638517253e-06, "entropy": 1.7874923944473267, "entropy_coeff": 0.19786666333675385, "model": {}}}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 4.498416, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.2492080000000003}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 4.5, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.0, "onion_pickup_agent_0_min": 3, "onion_pickup_agent_0_max": 9, "onion_pickup_agent_1_mean": 6.2, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 11, "useful_onion_pickup_agent_0_mean": 6.0, "useful_onion_pickup_agent_0_min": 3, "useful_onion_pickup_agent_0_max": 9, "useful_onion_pickup_agent_1_mean": 6.2, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 11, "onion_drop_agent_0_mean": 4.7, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 8, "onion_drop_agent_1_mean": 5.1, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.7, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 1.3, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 5, "dish_pickup_agent_1_mean": 2.4, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 5, "useful_dish_pickup_agent_0_mean": 0.1, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 1.2, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 5, "dish_drop_agent_1_mean": 2.3, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 5, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.3, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.7, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.7, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4707045085679362, "mean_inference_ms": 0.742555614118805, "mean_action_processing_ms": 0.07549724025773341, "mean_env_wait_ms": 0.40418127616181404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 4.498416, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.2492080000000003}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4707045085679362, "mean_inference_ms": 0.742555614118805, "mean_action_processing_ms": 0.07549724025773341, "mean_env_wait_ms": 0.40418127616181404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 4000, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 829.568, "learn_time_ms": 138.69, "learn_throughput": 5768.27, "synch_weights_time_ms": 4.754}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 10, "training_iteration": 5, "trial_id": "default", "experiment_id": "fccb36c3133749cb981cab189ff2c427", "date": "2023-06-17_14-01-02", "timestamp": 1687003262, "time_this_iter_s": 1.3949329853057861, "time_total_s": 7.490850448608398, "pid": 4612, "hostname": "LAPTOP-TER6F2CR", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F0210DA48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F620ADC48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 7.490850448608398, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 8.835330724716187, "perf": {"cpu_util_percent": 4.85, "ram_util_percent": 46.2}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.0, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.333333333333333, "onion_pickup_agent_0_min": 3, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 6.333333333333333, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 11, "useful_onion_pickup_agent_0_mean": 6.333333333333333, "useful_onion_pickup_agent_0_min": 3, "useful_onion_pickup_agent_0_max": 11, "useful_onion_pickup_agent_1_mean": 6.333333333333333, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 11, "onion_drop_agent_0_mean": 4.916666666666667, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 10, "onion_drop_agent_1_mean": 5.333333333333333, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.9166666666666666, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.5833333333333334, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 1.25, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 5, "dish_pickup_agent_1_mean": 2.3333333333333335, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 5, "useful_dish_pickup_agent_0_mean": 0.08333333333333333, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.08333333333333333, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 1.1666666666666667, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 5, "dish_drop_agent_1_mean": 2.25, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 5, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.1666666666666667, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.9166666666666666, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.5833333333333334, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9166666666666666, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.5833333333333334, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.004875000100582838, "cur_lr": 0.00015999999595806003, "total_loss": -0.35224249958992004, "policy_loss": -4.264339804649353e-05, "vf_loss": 0.037468284368515015, "vf_explained_var": 0.02325040102005005, "kl": 5.355896064429544e-06, "entropy": 1.7865681648254395, "entropy_coeff": 0.19733333587646484, "model": {}}}}, "num_env_steps_sampled": 4800, "num_env_steps_trained": 4800, "num_agent_steps_sampled": 9600, "num_agent_steps_trained": 9600}, "sampler_results": {"episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 4.997679999999999, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.49884}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.0, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.333333333333333, "onion_pickup_agent_0_min": 3, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 6.333333333333333, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 11, "useful_onion_pickup_agent_0_mean": 6.333333333333333, "useful_onion_pickup_agent_0_min": 3, "useful_onion_pickup_agent_0_max": 11, "useful_onion_pickup_agent_1_mean": 6.333333333333333, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 11, "onion_drop_agent_0_mean": 4.916666666666667, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 10, "onion_drop_agent_1_mean": 5.333333333333333, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.9166666666666666, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.5833333333333334, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 1.25, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 5, "dish_pickup_agent_1_mean": 2.3333333333333335, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 5, "useful_dish_pickup_agent_0_mean": 0.08333333333333333, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.08333333333333333, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 1.1666666666666667, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 5, "dish_drop_agent_1_mean": 2.25, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 5, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.1666666666666667, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.9166666666666666, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.5833333333333334, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9166666666666666, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.5833333333333334, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4701533041226418, "mean_inference_ms": 0.7390820516700586, "mean_action_processing_ms": 0.07486349695125184, "mean_env_wait_ms": 0.4045495174614613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 4.997679999999999, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.49884}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4701533041226418, "mean_inference_ms": 0.7390820516700586, "mean_action_processing_ms": 0.07486349695125184, "mean_env_wait_ms": 0.4045495174614613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 9600, "num_agent_steps_trained": 9600, "num_env_steps_sampled": 4800, "num_env_steps_trained": 4800, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 4800, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 9600, "timers": {"training_iteration_time_ms": 822.589, "learn_time_ms": 133.096, "learn_throughput": 6010.705, "synch_weights_time_ms": 4.295}, "counters": {"num_env_steps_sampled": 4800, "num_env_steps_trained": 4800, "num_agent_steps_sampled": 9600, "num_agent_steps_trained": 9600}, "done": false, "episodes_total": 12, "training_iteration": 6, "trial_id": "default", "experiment_id": "fccb36c3133749cb981cab189ff2c427", "date": "2023-06-17_14-01-03", "timestamp": 1687003263, "time_this_iter_s": 1.5108318328857422, "time_total_s": 9.00168228149414, "pid": 4612, "hostname": "LAPTOP-TER6F2CR", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F0210DA48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F620ADC48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 9.00168228149414, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 8.835330724716187, "perf": {"cpu_util_percent": 4.15, "ram_util_percent": 46.2}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.142857142857143, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.357142857142857, "onion_pickup_agent_0_min": 3, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.928571428571429, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 11, "useful_onion_pickup_agent_0_mean": 6.357142857142857, "useful_onion_pickup_agent_0_min": 3, "useful_onion_pickup_agent_0_max": 11, "useful_onion_pickup_agent_1_mean": 5.928571428571429, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 11, "onion_drop_agent_0_mean": 5.071428571428571, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 10, "onion_drop_agent_1_mean": 4.928571428571429, "onion_drop_agent_1_min": 1, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.8571428571428571, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.6428571428571429, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 1.0714285714285714, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 5, "dish_pickup_agent_1_mean": 2.142857142857143, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 5, "useful_dish_pickup_agent_0_mean": 0.07142857142857142, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.14285714285714285, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 1.0, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 5, "dish_drop_agent_1_mean": 2.0714285714285716, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 5, "useful_dish_drop_agent_0_mean": 0.8571428571428571, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.1428571428571428, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.8571428571428571, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.6428571428571429, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8571428571428571, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.6428571428571429, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.002437500050291419, "cur_lr": 0.00015999999595806003, "total_loss": -0.3516496419906616, "policy_loss": -0.00020414451137185097, "vf_loss": 0.029623281210660934, "vf_explained_var": 0.00495794415473938, "kl": 3.4432141546858475e-06, "entropy": 1.7872048616409302, "entropy_coeff": 0.19679999351501465, "model": {}}}}, "num_env_steps_sampled": 5600, "num_env_steps_trained": 5600, "num_agent_steps_sampled": 11200, "num_agent_steps_trained": 11200}, "sampler_results": {"episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.140045714285713, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.570022857142857}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.142857142857143, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.357142857142857, "onion_pickup_agent_0_min": 3, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.928571428571429, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 11, "useful_onion_pickup_agent_0_mean": 6.357142857142857, "useful_onion_pickup_agent_0_min": 3, "useful_onion_pickup_agent_0_max": 11, "useful_onion_pickup_agent_1_mean": 5.928571428571429, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 11, "onion_drop_agent_0_mean": 5.071428571428571, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 10, "onion_drop_agent_1_mean": 4.928571428571429, "onion_drop_agent_1_min": 1, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.8571428571428571, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.6428571428571429, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 1.0714285714285714, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 5, "dish_pickup_agent_1_mean": 2.142857142857143, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 5, "useful_dish_pickup_agent_0_mean": 0.07142857142857142, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.14285714285714285, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 1.0, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 5, "dish_drop_agent_1_mean": 2.0714285714285716, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 5, "useful_dish_drop_agent_0_mean": 0.8571428571428571, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.1428571428571428, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.8571428571428571, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.6428571428571429, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8571428571428571, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.6428571428571429, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4709108222027332, "mean_inference_ms": 0.7372400636707407, "mean_action_processing_ms": 0.07444340089205123, "mean_env_wait_ms": 0.4048582863669286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.140045714285713, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.570022857142857}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4709108222027332, "mean_inference_ms": 0.7372400636707407, "mean_action_processing_ms": 0.07444340089205123, "mean_env_wait_ms": 0.4048582863669286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 11200, "num_agent_steps_trained": 11200, "num_env_steps_sampled": 5600, "num_env_steps_trained": 5600, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 5600, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 11200, "timers": {"training_iteration_time_ms": 822.084, "learn_time_ms": 128.396, "learn_throughput": 6230.73, "synch_weights_time_ms": 4.041}, "counters": {"num_env_steps_sampled": 5600, "num_env_steps_trained": 5600, "num_agent_steps_sampled": 11200, "num_agent_steps_trained": 11200}, "done": false, "episodes_total": 14, "training_iteration": 7, "trial_id": "default", "experiment_id": "fccb36c3133749cb981cab189ff2c427", "date": "2023-06-17_14-01-05", "timestamp": 1687003265, "time_this_iter_s": 1.5001633167266846, "time_total_s": 10.501845598220825, "pid": 4612, "hostname": "LAPTOP-TER6F2CR", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F0210DA48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F620ADC48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 10.501845598220825, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 8.835330724716187, "perf": {"cpu_util_percent": 6.800000000000001, "ram_util_percent": 46.23333333333333}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.4375, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.9375, "onion_pickup_agent_0_min": 2, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.6875, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 11, "useful_onion_pickup_agent_0_mean": 5.9375, "useful_onion_pickup_agent_0_min": 2, "useful_onion_pickup_agent_0_max": 11, "useful_onion_pickup_agent_1_mean": 5.6875, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 11, "onion_drop_agent_0_mean": 4.625, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 10, "onion_drop_agent_1_mean": 4.6875, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.9375, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.6875, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 1.1875, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 5, "dish_pickup_agent_1_mean": 2.4375, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.0625, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.125, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 1.125, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 5, "dish_drop_agent_1_mean": 2.375, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 0.9375, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.1875, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.9375, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.6875, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9375, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.6875, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.0012187500251457095, "cur_lr": 0.00015999999595806003, "total_loss": -0.3504173159599304, "policy_loss": -0.00022504571825265884, "vf_loss": 0.037830665707588196, "vf_explained_var": -0.0020498931407928467, "kl": 6.147816748125479e-06, "entropy": 1.7860660552978516, "entropy_coeff": 0.19626666605472565, "model": {}}}}, "num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "sampler_results": {"episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.43399, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.716995}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.4375, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.9375, "onion_pickup_agent_0_min": 2, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.6875, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 11, "useful_onion_pickup_agent_0_mean": 5.9375, "useful_onion_pickup_agent_0_min": 2, "useful_onion_pickup_agent_0_max": 11, "useful_onion_pickup_agent_1_mean": 5.6875, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 11, "onion_drop_agent_0_mean": 4.625, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 10, "onion_drop_agent_1_mean": 4.6875, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.9375, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.6875, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 1.1875, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 5, "dish_pickup_agent_1_mean": 2.4375, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.0625, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.125, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 1.125, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 5, "dish_drop_agent_1_mean": 2.375, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 0.9375, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.1875, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.9375, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.6875, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9375, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.6875, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47196015342888864, "mean_inference_ms": 0.7358946359868834, "mean_action_processing_ms": 0.07415276399374854, "mean_env_wait_ms": 0.40583862045236324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.43399, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.716995}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47196015342888864, "mean_inference_ms": 0.7358946359868834, "mean_action_processing_ms": 0.07415276399374854, "mean_env_wait_ms": 0.40583862045236324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800, "num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 6400, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 12800, "timers": {"training_iteration_time_ms": 825.226, "learn_time_ms": 125.23, "learn_throughput": 6388.248, "synch_weights_time_ms": 3.786}, "counters": {"num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "done": false, "episodes_total": 16, "training_iteration": 8, "trial_id": "default", "experiment_id": "fccb36c3133749cb981cab189ff2c427", "date": "2023-06-17_14-01-07", "timestamp": 1687003267, "time_this_iter_s": 1.4983582496643066, "time_total_s": 12.000203847885132, "pid": 4612, "hostname": "LAPTOP-TER6F2CR", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F0210DA48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F620ADC48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 12.000203847885132, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 8.835330724716187, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 46.2}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.5, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.0, "onion_pickup_agent_0_min": 2, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.611111111111111, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 11, "useful_onion_pickup_agent_0_mean": 6.0, "useful_onion_pickup_agent_0_min": 2, "useful_onion_pickup_agent_0_max": 11, "useful_onion_pickup_agent_1_mean": 5.611111111111111, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 11, "onion_drop_agent_0_mean": 4.666666666666667, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 10, "onion_drop_agent_1_mean": 4.5, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.9444444444444444, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7222222222222222, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 1.4444444444444444, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 7, "dish_pickup_agent_1_mean": 2.611111111111111, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.05555555555555555, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1111111111111111, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 1.3888888888888888, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 2.5555555555555554, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 1.1111111111111112, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.1111111111111112, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.9444444444444444, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7222222222222222, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9444444444444444, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7222222222222222, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.0006093750125728548, "cur_lr": 0.00015999999595806003, "total_loss": -0.3494471609592438, "policy_loss": -0.00020442157983779907, "vf_loss": 0.030110202729701996, "vf_explained_var": 0.00715753436088562, "kl": 7.326973445742624e-06, "entropy": 1.7857134342193604, "entropy_coeff": 0.19573333859443665, "model": {}}}}, "num_env_steps_sampled": 7200, "num_env_steps_trained": 7200, "num_agent_steps_sampled": 14400, "num_agent_steps_trained": 14400}, "sampler_results": {"episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.496026666666666, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.7480133333333336}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.5, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.0, "onion_pickup_agent_0_min": 2, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.611111111111111, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 11, "useful_onion_pickup_agent_0_mean": 6.0, "useful_onion_pickup_agent_0_min": 2, "useful_onion_pickup_agent_0_max": 11, "useful_onion_pickup_agent_1_mean": 5.611111111111111, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 11, "onion_drop_agent_0_mean": 4.666666666666667, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 10, "onion_drop_agent_1_mean": 4.5, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.9444444444444444, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7222222222222222, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 1.4444444444444444, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 7, "dish_pickup_agent_1_mean": 2.611111111111111, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.05555555555555555, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1111111111111111, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 1.3888888888888888, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 2.5555555555555554, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 1.1111111111111112, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.1111111111111112, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.9444444444444444, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7222222222222222, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9444444444444444, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7222222222222222, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664, 8.988480000000001, 2.99616], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0, 2.99616, 5.99232, 2.99616, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4729857841329744, "mean_inference_ms": 0.7354049505994716, "mean_action_processing_ms": 0.07378249930109892, "mean_env_wait_ms": 0.4070117357367733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.496026666666666, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.7480133333333336}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664, 8.988480000000001, 2.99616], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0, 2.99616, 5.99232, 2.99616, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4729857841329744, "mean_inference_ms": 0.7354049505994716, "mean_action_processing_ms": 0.07378249930109892, "mean_env_wait_ms": 0.4070117357367733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 14400, "num_agent_steps_trained": 14400, "num_env_steps_sampled": 7200, "num_env_steps_trained": 7200, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 7200, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 14400, "timers": {"training_iteration_time_ms": 826.637, "learn_time_ms": 122.472, "learn_throughput": 6532.083, "synch_weights_time_ms": 3.737}, "counters": {"num_env_steps_sampled": 7200, "num_env_steps_trained": 7200, "num_agent_steps_sampled": 14400, "num_agent_steps_trained": 14400}, "done": false, "episodes_total": 18, "training_iteration": 9, "trial_id": "default", "experiment_id": "fccb36c3133749cb981cab189ff2c427", "date": "2023-06-17_14-01-08", "timestamp": 1687003268, "time_this_iter_s": 1.4836757183074951, "time_total_s": 13.483879566192627, "pid": 4612, "hostname": "LAPTOP-TER6F2CR", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F0210DA48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F620ADC48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 13.483879566192627, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 8.835330724716187, "perf": {"cpu_util_percent": 2.95, "ram_util_percent": 46.25}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.85, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.2, "onion_pickup_agent_0_min": 2, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.95, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 6.2, "useful_onion_pickup_agent_0_min": 2, "useful_onion_pickup_agent_0_max": 11, "useful_onion_pickup_agent_1_mean": 5.95, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.85, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 10, "onion_drop_agent_1_mean": 4.7, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.95, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 1.65, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 7, "dish_pickup_agent_1_mean": 2.4, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.1, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 1.6, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 2.35, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 1.15, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.05, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.95, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.95, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.0003046875062864274, "cur_lr": 0.00015999999595806003, "total_loss": -0.34801962971687317, "policy_loss": -0.00012083910405635834, "vf_loss": 0.0451081283390522, "vf_explained_var": -0.010305196046829224, "kl": 1.0110385119332932e-05, "entropy": 1.7844243049621582, "entropy_coeff": 0.19519999623298645, "model": {}}}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.845128, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.9225640000000004}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.85, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.2, "onion_pickup_agent_0_min": 2, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.95, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 6.2, "useful_onion_pickup_agent_0_min": 2, "useful_onion_pickup_agent_0_max": 11, "useful_onion_pickup_agent_1_mean": 5.95, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.85, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 10, "onion_drop_agent_1_mean": 4.7, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.95, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 1.65, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 7, "dish_pickup_agent_1_mean": 2.4, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.1, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 1.6, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 2.35, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 1.15, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.05, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.95, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.95, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664, 8.988480000000001, 2.99616, 8.98704, 8.98704], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0, 2.99616, 5.99232, 2.99616, 0.0, 5.99136, 2.99568, 2.99568, 5.99136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47369507486807444, "mean_inference_ms": 0.7345687442672235, "mean_action_processing_ms": 0.07354956658973427, "mean_env_wait_ms": 0.4078820413988854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.845128, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.9225640000000004}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664, 8.988480000000001, 2.99616, 8.98704, 8.98704], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0, 2.99616, 5.99232, 2.99616, 0.0, 5.99136, 2.99568, 2.99568, 5.99136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47369507486807444, "mean_inference_ms": 0.7345687442672235, "mean_action_processing_ms": 0.07354956658973427, "mean_env_wait_ms": 0.4078820413988854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 8000, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 822.421, "learn_time_ms": 120.32, "learn_throughput": 6648.947, "synch_weights_time_ms": 3.615}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 20, "training_iteration": 10, "trial_id": "default", "experiment_id": "fccb36c3133749cb981cab189ff2c427", "date": "2023-06-17_14-01-10", "timestamp": 1687003270, "time_this_iter_s": 1.439211130142212, "time_total_s": 14.923090696334839, "pid": 4612, "hostname": "LAPTOP-TER6F2CR", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F0210DA48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F620ADC48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 14.923090696334839, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 8.835330724716187, "perf": {"cpu_util_percent": 3.8499999999999996, "ram_util_percent": 46.25}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.7272727272727275, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.181818181818182, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 12, "onion_pickup_agent_1_mean": 5.954545454545454, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 6.181818181818182, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 12, "useful_onion_pickup_agent_1_mean": 5.954545454545454, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.954545454545454, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 4.681818181818182, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.8636363636363636, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8636363636363636, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 2.0454545454545454, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 10, "dish_pickup_agent_1_mean": 2.5, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.09090909090909091, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.09090909090909091, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 1.9545454545454546, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 9, "dish_drop_agent_1_mean": 2.409090909090909, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 1.4545454545454546, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 8, "useful_dish_drop_agent_1_mean": 1.2272727272727273, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 5, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.8636363636363636, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8636363636363636, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8636363636363636, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8636363636363636, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.0001523437531432137, "cur_lr": 0.00015999999595806003, "total_loss": -0.34687522053718567, "policy_loss": -8.297152817249298e-06, "vf_loss": 0.022426949813961983, "vf_explained_var": 0.02748766541481018, "kl": 1.2386366506689228e-05, "entropy": 1.7829254865646362, "entropy_coeff": 0.19466666877269745, "model": {}}}}, "num_env_steps_sampled": 8800, "num_env_steps_trained": 8800, "num_agent_steps_sampled": 17600, "num_agent_steps_trained": 17600}, "sampler_results": {"episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.72218909090909, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.8610945454545456}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.7272727272727275, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.181818181818182, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 12, "onion_pickup_agent_1_mean": 5.954545454545454, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 6.181818181818182, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 12, "useful_onion_pickup_agent_1_mean": 5.954545454545454, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.954545454545454, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 4.681818181818182, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.8636363636363636, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8636363636363636, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 2.0454545454545454, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 10, "dish_pickup_agent_1_mean": 2.5, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.09090909090909091, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.09090909090909091, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 1.9545454545454546, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 9, "dish_drop_agent_1_mean": 2.409090909090909, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 1.4545454545454546, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 8, "useful_dish_drop_agent_1_mean": 1.2272727272727273, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 5, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.8636363636363636, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8636363636363636, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8636363636363636, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8636363636363636, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664, 8.988480000000001, 2.99616, 8.98704, 8.98704, 2.9951999999999996, 5.990399999999999], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0, 2.99616, 5.99232, 2.99616, 0.0, 5.99136, 2.99568, 2.99568, 5.99136, 0.0, 2.9951999999999996, 0.0, 5.990399999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4742008833026658, "mean_inference_ms": 0.7341292532807745, "mean_action_processing_ms": 0.0733977365838485, "mean_env_wait_ms": 0.409022718976642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.72218909090909, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.8610945454545456}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664, 8.988480000000001, 2.99616, 8.98704, 8.98704, 2.9951999999999996, 5.990399999999999], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0, 2.99616, 5.99232, 2.99616, 0.0, 5.99136, 2.99568, 2.99568, 5.99136, 0.0, 2.9951999999999996, 0.0, 5.990399999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4742008833026658, "mean_inference_ms": 0.7341292532807745, "mean_action_processing_ms": 0.0733977365838485, "mean_env_wait_ms": 0.409022718976642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 17600, "num_agent_steps_trained": 17600, "num_env_steps_sampled": 8800, "num_env_steps_trained": 8800, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 8800, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 17600, "timers": {"training_iteration_time_ms": 803.375, "learn_time_ms": 101.699, "learn_throughput": 7866.357, "synch_weights_time_ms": 2.421}, "counters": {"num_env_steps_sampled": 8800, "num_env_steps_trained": 8800, "num_agent_steps_sampled": 17600, "num_agent_steps_trained": 17600}, "done": false, "episodes_total": 22, "training_iteration": 11, "trial_id": "default", "experiment_id": "fccb36c3133749cb981cab189ff2c427", "date": "2023-06-17_14-01-11", "timestamp": 1687003271, "time_this_iter_s": 1.4764518737792969, "time_total_s": 16.399542570114136, "pid": 4612, "hostname": "LAPTOP-TER6F2CR", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F0210DA48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F620ADC48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 16.399542570114136, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 8.835330724716187, "perf": {"cpu_util_percent": 4.166666666666667, "ram_util_percent": 46.20000000000001}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 6.0, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.041666666666667, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 12, "onion_pickup_agent_1_mean": 6.041666666666667, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 6.041666666666667, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 12, "useful_onion_pickup_agent_1_mean": 6.041666666666667, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.791666666666667, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 4.791666666666667, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.9166666666666666, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.875, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 2.125, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 10, "dish_pickup_agent_1_mean": 2.5833333333333335, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.125, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.08333333333333333, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.0, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 9, "dish_drop_agent_1_mean": 2.5, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 1.4583333333333333, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 8, "useful_dish_drop_agent_1_mean": 1.375, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 6, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.9166666666666666, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.875, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9166666666666666, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.875, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 7.617187657160684e-05, "cur_lr": 0.00015999999595806003, "total_loss": -0.3457612097263336, "policy_loss": -0.0002852613106369972, "vf_loss": 0.04510634019970894, "vf_explained_var": -0.006683826446533203, "kl": 9.316917385149281e-06, "entropy": 1.7817485332489014, "entropy_coeff": 0.19413332641124725, "model": {}}}}, "num_env_steps_sampled": 9600, "num_env_steps_trained": 9600, "num_agent_steps_sampled": 19200, "num_agent_steps_trained": 19200}, "sampler_results": {"episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.994019999999999, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.99701}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 6.0, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.041666666666667, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 12, "onion_pickup_agent_1_mean": 6.041666666666667, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 6.041666666666667, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 12, "useful_onion_pickup_agent_1_mean": 6.041666666666667, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.791666666666667, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 4.791666666666667, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.9166666666666666, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.875, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 2.125, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 10, "dish_pickup_agent_1_mean": 2.5833333333333335, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.125, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.08333333333333333, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.0, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 9, "dish_drop_agent_1_mean": 2.5, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 1.4583333333333333, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 8, "useful_dish_drop_agent_1_mean": 1.375, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 6, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.9166666666666666, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.875, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9166666666666666, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.875, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664, 8.988480000000001, 2.99616, 8.98704, 8.98704, 2.9951999999999996, 5.990399999999999, 5.98944, 11.97888], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0, 2.99616, 5.99232, 2.99616, 0.0, 5.99136, 2.99568, 2.99568, 5.99136, 0.0, 2.9951999999999996, 0.0, 5.990399999999999, 2.99472, 2.99472, 8.98416, 2.99472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47471418875959076, "mean_inference_ms": 0.7334686600626227, "mean_action_processing_ms": 0.07315963678545849, "mean_env_wait_ms": 0.40991179129420857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.994019999999999, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.99701}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664, 8.988480000000001, 2.99616, 8.98704, 8.98704, 2.9951999999999996, 5.990399999999999, 5.98944, 11.97888], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0, 2.99616, 5.99232, 2.99616, 0.0, 5.99136, 2.99568, 2.99568, 5.99136, 0.0, 2.9951999999999996, 0.0, 5.990399999999999, 2.99472, 2.99472, 8.98416, 2.99472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47471418875959076, "mean_inference_ms": 0.7334686600626227, "mean_action_processing_ms": 0.07315963678545849, "mean_env_wait_ms": 0.40991179129420857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 19200, "num_agent_steps_trained": 19200, "num_env_steps_sampled": 9600, "num_env_steps_trained": 9600, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 9600, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 19200, "timers": {"training_iteration_time_ms": 801.422, "learn_time_ms": 101.346, "learn_throughput": 7893.727, "synch_weights_time_ms": 2.304}, "counters": {"num_env_steps_sampled": 9600, "num_env_steps_trained": 9600, "num_agent_steps_sampled": 19200, "num_agent_steps_trained": 19200}, "done": false, "episodes_total": 24, "training_iteration": 12, "trial_id": "default", "experiment_id": "fccb36c3133749cb981cab189ff2c427", "date": "2023-06-17_14-01-13", "timestamp": 1687003273, "time_this_iter_s": 1.3976473808288574, "time_total_s": 17.797189950942993, "pid": 4612, "hostname": "LAPTOP-TER6F2CR", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F0210DA48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F620ADC48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 17.797189950942993, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 8.835330724716187, "perf": {"cpu_util_percent": 2.9, "ram_util_percent": 46.2}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.538461538461538, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.076923076923077, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 12, "onion_pickup_agent_1_mean": 6.153846153846154, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 6.076923076923077, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 12, "useful_onion_pickup_agent_1_mean": 6.153846153846154, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.884615384615385, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 4.961538461538462, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.8461538461538461, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8076923076923077, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 2.0, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 10, "dish_pickup_agent_1_mean": 2.6538461538461537, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.11538461538461539, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.07692307692307693, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 1.8846153846153846, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 9, "dish_drop_agent_1_mean": 2.576923076923077, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 1.3461538461538463, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 8, "useful_dish_drop_agent_1_mean": 1.3076923076923077, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 6, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.8461538461538461, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8076923076923077, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8461538461538461, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8076923076923077, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 3.808593828580342e-05, "cur_lr": 0.00015999999595806003, "total_loss": -0.3449162542819977, "policy_loss": -0.00014679692685604095, "vf_loss": 0.00044030899880453944, "vf_explained_var": 0.5967856645584106, "kl": 9.561284059600439e-06, "entropy": 1.7808551788330078, "entropy_coeff": 0.19359999895095825, "model": {}}}}, "num_env_steps_sampled": 10400, "num_env_steps_trained": 10400, "num_agent_steps_sampled": 20800, "num_agent_steps_trained": 20800}, "sampler_results": {"episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.532941538461538, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.7664707692307693}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.538461538461538, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.076923076923077, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 12, "onion_pickup_agent_1_mean": 6.153846153846154, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 6.076923076923077, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 12, "useful_onion_pickup_agent_1_mean": 6.153846153846154, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.884615384615385, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 4.961538461538462, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.8461538461538461, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8076923076923077, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 2.0, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 10, "dish_pickup_agent_1_mean": 2.6538461538461537, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.11538461538461539, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.07692307692307693, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 1.8846153846153846, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 9, "dish_drop_agent_1_mean": 2.576923076923077, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 1.3461538461538463, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 8, "useful_dish_drop_agent_1_mean": 1.3076923076923077, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 6, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.8461538461538461, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8076923076923077, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8461538461538461, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8076923076923077, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664, 8.988480000000001, 2.99616, 8.98704, 8.98704, 2.9951999999999996, 5.990399999999999, 5.98944, 11.97888, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0, 2.99616, 5.99232, 2.99616, 0.0, 5.99136, 2.99568, 2.99568, 5.99136, 0.0, 2.9951999999999996, 0.0, 5.990399999999999, 2.99472, 2.99472, 8.98416, 2.99472, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47718675644929986, "mean_inference_ms": 0.7330142984515226, "mean_action_processing_ms": 0.0730094129767835, "mean_env_wait_ms": 0.4104524899293264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.532941538461538, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.7664707692307693}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664, 8.988480000000001, 2.99616, 8.98704, 8.98704, 2.9951999999999996, 5.990399999999999, 5.98944, 11.97888, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0, 2.99616, 5.99232, 2.99616, 0.0, 5.99136, 2.99568, 2.99568, 5.99136, 0.0, 2.9951999999999996, 0.0, 5.990399999999999, 2.99472, 2.99472, 8.98416, 2.99472, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47718675644929986, "mean_inference_ms": 0.7330142984515226, "mean_action_processing_ms": 0.0730094129767835, "mean_env_wait_ms": 0.4104524899293264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 20800, "num_agent_steps_trained": 20800, "num_env_steps_sampled": 10400, "num_env_steps_trained": 10400, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 10400, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 20800, "timers": {"training_iteration_time_ms": 815.51, "learn_time_ms": 101.608, "learn_throughput": 7873.376, "synch_weights_time_ms": 2.348}, "counters": {"num_env_steps_sampled": 10400, "num_env_steps_trained": 10400, "num_agent_steps_sampled": 20800, "num_agent_steps_trained": 20800}, "done": false, "episodes_total": 26, "training_iteration": 13, "trial_id": "default", "experiment_id": "fccb36c3133749cb981cab189ff2c427", "date": "2023-06-17_14-01-15", "timestamp": 1687003275, "time_this_iter_s": 1.6060683727264404, "time_total_s": 19.403258323669434, "pid": 4612, "hostname": "LAPTOP-TER6F2CR", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F0210DA48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F620ADC48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 19.403258323669434, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 8.835330724716187, "perf": {"cpu_util_percent": 4.15, "ram_util_percent": 46.2}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.464285714285714, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.214285714285714, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 14, "onion_pickup_agent_1_mean": 5.785714285714286, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 6.214285714285714, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 14, "useful_onion_pickup_agent_1_mean": 5.785714285714286, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.964285714285714, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 4.642857142857143, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.8928571428571429, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.75, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 2.0357142857142856, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 10, "dish_pickup_agent_1_mean": 3.107142857142857, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.10714285714285714, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.07142857142857142, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 1.9285714285714286, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 9, "dish_drop_agent_1_mean": 3.0, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 1.4285714285714286, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 8, "useful_dish_drop_agent_1_mean": 1.7857142857142858, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 8, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.8928571428571429, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.75, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8928571428571429, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.75, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 1.904296914290171e-05, "cur_lr": 0.00015999999595806003, "total_loss": -0.3436834216117859, "policy_loss": -0.0002722222125157714, "vf_loss": 0.023034706711769104, "vf_explained_var": 0.02126440405845642, "kl": 6.792682597733801e-06, "entropy": 1.7798314094543457, "entropy_coeff": 0.19306667149066925, "model": {}}}}, "num_env_steps_sampled": 11200, "num_env_steps_trained": 11200, "num_agent_steps_sampled": 22400, "num_agent_steps_trained": 22400}, "sampler_results": {"episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.458491428571428, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.7292457142857143}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.464285714285714, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.214285714285714, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 14, "onion_pickup_agent_1_mean": 5.785714285714286, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 6.214285714285714, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 14, "useful_onion_pickup_agent_1_mean": 5.785714285714286, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.964285714285714, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 4.642857142857143, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.8928571428571429, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.75, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 2.0357142857142856, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 10, "dish_pickup_agent_1_mean": 3.107142857142857, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.10714285714285714, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.07142857142857142, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 1.9285714285714286, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 9, "dish_drop_agent_1_mean": 3.0, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 1.4285714285714286, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 8, "useful_dish_drop_agent_1_mean": 1.7857142857142858, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 8, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.8928571428571429, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.75, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8928571428571429, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.75, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664, 8.988480000000001, 2.99616, 8.98704, 8.98704, 2.9951999999999996, 5.990399999999999, 5.98944, 11.97888, 0.0, 0.0, 0.0, 8.98128], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0, 2.99616, 5.99232, 2.99616, 0.0, 5.99136, 2.99568, 2.99568, 5.99136, 0.0, 2.9951999999999996, 0.0, 5.990399999999999, 2.99472, 2.99472, 8.98416, 2.99472, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.98128, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47912446650653856, "mean_inference_ms": 0.7326413877996275, "mean_action_processing_ms": 0.0728455559458278, "mean_env_wait_ms": 0.41107800902813335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.458491428571428, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.7292457142857143}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664, 8.988480000000001, 2.99616, 8.98704, 8.98704, 2.9951999999999996, 5.990399999999999, 5.98944, 11.97888, 0.0, 0.0, 0.0, 8.98128], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0, 2.99616, 5.99232, 2.99616, 0.0, 5.99136, 2.99568, 2.99568, 5.99136, 0.0, 2.9951999999999996, 0.0, 5.990399999999999, 2.99472, 2.99472, 8.98416, 2.99472, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.98128, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47912446650653856, "mean_inference_ms": 0.7326413877996275, "mean_action_processing_ms": 0.0728455559458278, "mean_env_wait_ms": 0.41107800902813335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 22400, "num_agent_steps_trained": 22400, "num_env_steps_sampled": 11200, "num_env_steps_trained": 11200, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 11200, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 22400, "timers": {"training_iteration_time_ms": 820.024, "learn_time_ms": 102.716, "learn_throughput": 7788.5, "synch_weights_time_ms": 2.397}, "counters": {"num_env_steps_sampled": 11200, "num_env_steps_trained": 11200, "num_agent_steps_sampled": 22400, "num_agent_steps_trained": 22400}, "done": false, "episodes_total": 28, "training_iteration": 14, "trial_id": "default", "experiment_id": "fccb36c3133749cb981cab189ff2c427", "date": "2023-06-17_14-01-16", "timestamp": 1687003276, "time_this_iter_s": 1.460207223892212, "time_total_s": 20.863465547561646, "pid": 4612, "hostname": "LAPTOP-TER6F2CR", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F0210DA48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F620ADC48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 20.863465547561646, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 8.835330724716187, "perf": {"cpu_util_percent": 3.9, "ram_util_percent": 46.13333333333333}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.4, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.3, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 14, "onion_pickup_agent_1_mean": 6.133333333333334, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 13, "useful_onion_pickup_agent_0_mean": 6.3, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 14, "useful_onion_pickup_agent_1_mean": 6.133333333333334, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 13, "onion_drop_agent_0_mean": 4.966666666666667, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 5.033333333333333, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 13, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.9333333333333333, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 2.066666666666667, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 10, "dish_pickup_agent_1_mean": 2.933333333333333, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.1, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.06666666666666667, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 1.9666666666666666, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 9, "dish_drop_agent_1_mean": 2.8333333333333335, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 1.4, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 8, "useful_dish_drop_agent_1_mean": 1.7, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 8, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.9333333333333333, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9333333333333333, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 9.521484571450856e-06, "cur_lr": 0.00015999999595806003, "total_loss": -0.3425571918487549, "policy_loss": -0.00024459464475512505, "vf_loss": 0.02282090112566948, "vf_explained_var": 0.046372950077056885, "kl": 8.243804586527403e-06, "entropy": 1.7790452241897583, "entropy_coeff": 0.19253332912921906, "model": {}}}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.393919999999999, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.69696}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.4, "shaped_reward_min": 0, "shaped_reward_max": 12, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.3, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 14, "onion_pickup_agent_1_mean": 6.133333333333334, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 13, "useful_onion_pickup_agent_0_mean": 6.3, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 14, "useful_onion_pickup_agent_1_mean": 6.133333333333334, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 13, "onion_drop_agent_0_mean": 4.966666666666667, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 5.033333333333333, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 13, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.9333333333333333, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 2.066666666666667, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 10, "dish_pickup_agent_1_mean": 2.933333333333333, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.1, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.06666666666666667, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 1.9666666666666666, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 9, "dish_drop_agent_1_mean": 2.8333333333333335, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 1.4, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 8, "useful_dish_drop_agent_1_mean": 1.7, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 8, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.9333333333333333, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9333333333333333, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664, 8.988480000000001, 2.99616, 8.98704, 8.98704, 2.9951999999999996, 5.990399999999999, 5.98944, 11.97888, 0.0, 0.0, 0.0, 8.98128, 2.99328, 5.98656], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0, 2.99616, 5.99232, 2.99616, 0.0, 5.99136, 2.99568, 2.99568, 5.99136, 0.0, 2.9951999999999996, 0.0, 5.990399999999999, 2.99472, 2.99472, 8.98416, 2.99472, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.98128, 0.0, 2.99328, 0.0, 5.98656, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062830307187515, "mean_inference_ms": 0.7320833398908289, "mean_action_processing_ms": 0.07268954367278632, "mean_env_wait_ms": 0.4115401500995267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 11.99616, "episode_reward_min": 0.0, "episode_reward_mean": 5.393919999999999, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.69696}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664, 8.988480000000001, 2.99616, 8.98704, 8.98704, 2.9951999999999996, 5.990399999999999, 5.98944, 11.97888, 0.0, 0.0, 0.0, 8.98128, 2.99328, 5.98656], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0, 2.99616, 5.99232, 2.99616, 0.0, 5.99136, 2.99568, 2.99568, 5.99136, 0.0, 2.9951999999999996, 0.0, 5.990399999999999, 2.99472, 2.99472, 8.98416, 2.99472, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.98128, 0.0, 2.99328, 0.0, 5.98656, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062830307187515, "mean_inference_ms": 0.7320833398908289, "mean_action_processing_ms": 0.07268954367278632, "mean_env_wait_ms": 0.4115401500995267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 12000, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 819.268, "learn_time_ms": 102.405, "learn_throughput": 7812.106, "synch_weights_time_ms": 2.492}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 30, "training_iteration": 15, "trial_id": "default", "experiment_id": "fccb36c3133749cb981cab189ff2c427", "date": "2023-06-17_14-01-18", "timestamp": 1687003278, "time_this_iter_s": 1.4009380340576172, "time_total_s": 22.264403581619263, "pid": 4612, "hostname": "LAPTOP-TER6F2CR", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F0210DA48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F620ADC48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 22.264403581619263, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 8.835330724716187, "perf": {"cpu_util_percent": 2.2, "ram_util_percent": 46.1}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.8125, "shaped_reward_min": 0, "shaped_reward_max": 18, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.375, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 14, "onion_pickup_agent_1_mean": 6.09375, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 13, "useful_onion_pickup_agent_0_mean": 6.375, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 14, "useful_onion_pickup_agent_1_mean": 6.09375, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 13, "onion_drop_agent_0_mean": 5.0, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 4.90625, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 13, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.96875, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.78125, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.125, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 10, "dish_pickup_agent_1_mean": 3.125, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 12, "useful_dish_pickup_agent_0_mean": 0.125, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.0625, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.03125, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 9, "dish_drop_agent_1_mean": 3.03125, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 12, "useful_dish_drop_agent_0_mean": 1.46875, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 8, "useful_dish_drop_agent_1_mean": 1.875, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 9, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.96875, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.78125, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.96875, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.78125, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 4.760742285725428e-06, "cur_lr": 0.00015999999595806003, "total_loss": -0.34120047092437744, "policy_loss": -0.0002575656399130821, "vf_loss": 0.059759728610515594, "vf_explained_var": 0.000789344310760498, "kl": 1.571762732055504e-05, "entropy": 1.7786481380462646, "entropy_coeff": 0.19200000166893005, "model": {}}}}, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "sampler_results": {"episode_reward_max": 17.956799999999998, "episode_reward_min": 0.0, "episode_reward_mean": 5.805, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.9025000000000003}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.8125, "shaped_reward_min": 0, "shaped_reward_max": 18, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.375, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 14, "onion_pickup_agent_1_mean": 6.09375, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 13, "useful_onion_pickup_agent_0_mean": 6.375, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 14, "useful_onion_pickup_agent_1_mean": 6.09375, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 13, "onion_drop_agent_0_mean": 5.0, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 4.90625, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 13, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.96875, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.78125, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.125, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 10, "dish_pickup_agent_1_mean": 3.125, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 12, "useful_dish_pickup_agent_0_mean": 0.125, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.0625, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.03125, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 9, "dish_drop_agent_1_mean": 3.03125, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 12, "useful_dish_drop_agent_0_mean": 1.46875, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 8, "useful_dish_drop_agent_1_mean": 1.875, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 9, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.96875, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.78125, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.96875, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.78125, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664, 8.988480000000001, 2.99616, 8.98704, 8.98704, 2.9951999999999996, 5.990399999999999, 5.98944, 11.97888, 0.0, 0.0, 0.0, 8.98128, 2.99328, 5.98656, 17.956799999999998, 5.9856], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0, 2.99616, 5.99232, 2.99616, 0.0, 5.99136, 2.99568, 2.99568, 5.99136, 0.0, 2.9951999999999996, 0.0, 5.990399999999999, 2.99472, 2.99472, 8.98416, 2.99472, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.98128, 0.0, 2.99328, 0.0, 5.98656, 0.0, 5.9856, 11.9712, 5.9856, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4819959724984408, "mean_inference_ms": 0.7313600164412769, "mean_action_processing_ms": 0.07252490699731498, "mean_env_wait_ms": 0.41197621820699265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 17.956799999999998, "episode_reward_min": 0.0, "episode_reward_mean": 5.805, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.9025000000000003}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664, 8.988480000000001, 2.99616, 8.98704, 8.98704, 2.9951999999999996, 5.990399999999999, 5.98944, 11.97888, 0.0, 0.0, 0.0, 8.98128, 2.99328, 5.98656, 17.956799999999998, 5.9856], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0, 2.99616, 5.99232, 2.99616, 0.0, 5.99136, 2.99568, 2.99568, 5.99136, 0.0, 2.9951999999999996, 0.0, 5.990399999999999, 2.99472, 2.99472, 8.98416, 2.99472, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.98128, 0.0, 2.99328, 0.0, 5.98656, 0.0, 5.9856, 11.9712, 5.9856, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4819959724984408, "mean_inference_ms": 0.7313600164412769, "mean_action_processing_ms": 0.07252490699731498, "mean_env_wait_ms": 0.41197621820699265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 12800, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 25600, "timers": {"training_iteration_time_ms": 818.756, "learn_time_ms": 101.809, "learn_throughput": 7857.829, "synch_weights_time_ms": 2.547}, "counters": {"num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "done": false, "episodes_total": 32, "training_iteration": 16, "trial_id": "default", "experiment_id": "fccb36c3133749cb981cab189ff2c427", "date": "2023-06-17_14-01-20", "timestamp": 1687003280, "time_this_iter_s": 1.432616949081421, "time_total_s": 23.697020530700684, "pid": 4612, "hostname": "LAPTOP-TER6F2CR", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F0210DA48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F620ADC48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 23.697020530700684, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 8.835330724716187, "perf": {"cpu_util_percent": 3.2, "ram_util_percent": 46.1}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.5588235294117645, "shaped_reward_min": 0, "shaped_reward_max": 18, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.411764705882353, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 14, "onion_pickup_agent_1_mean": 5.970588235294118, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 13, "useful_onion_pickup_agent_0_mean": 6.411764705882353, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 14, "useful_onion_pickup_agent_1_mean": 5.970588235294118, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 13, "onion_drop_agent_0_mean": 5.117647058823529, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 4.794117647058823, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 13, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.9117647058823529, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7647058823529411, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.1176470588235294, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 10, "dish_pickup_agent_1_mean": 3.088235294117647, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 12, "useful_dish_pickup_agent_0_mean": 0.11764705882352941, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.058823529411764705, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.0294117647058822, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 9, "dish_drop_agent_1_mean": 3.0, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 12, "useful_dish_drop_agent_0_mean": 1.5, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 8, "useful_dish_drop_agent_1_mean": 1.911764705882353, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 9, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.9117647058823529, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7647058823529411, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9117647058823529, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7647058823529411, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 2.380371142862714e-06, "cur_lr": 0.00015999999595806003, "total_loss": -0.34011924266815186, "policy_loss": -0.000230422243475914, "vf_loss": 0.00803326815366745, "vf_explained_var": 0.2968793213367462, "kl": 1.2512057764979545e-05, "entropy": 1.7755768299102783, "entropy_coeff": 0.19146665930747986, "model": {}}}}, "num_env_steps_sampled": 13600, "num_env_steps_trained": 13600, "num_agent_steps_sampled": 27200, "num_agent_steps_trained": 27200}, "sampler_results": {"episode_reward_max": 17.956799999999998, "episode_reward_min": 0.0, "episode_reward_mean": 5.551538823529412, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.7757694117647063}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.5588235294117645, "shaped_reward_min": 0, "shaped_reward_max": 18, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.411764705882353, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 14, "onion_pickup_agent_1_mean": 5.970588235294118, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 13, "useful_onion_pickup_agent_0_mean": 6.411764705882353, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 14, "useful_onion_pickup_agent_1_mean": 5.970588235294118, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 13, "onion_drop_agent_0_mean": 5.117647058823529, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 4.794117647058823, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 13, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.9117647058823529, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7647058823529411, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.1176470588235294, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 10, "dish_pickup_agent_1_mean": 3.088235294117647, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 12, "useful_dish_pickup_agent_0_mean": 0.11764705882352941, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.058823529411764705, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.0294117647058822, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 9, "dish_drop_agent_1_mean": 3.0, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 12, "useful_dish_drop_agent_0_mean": 1.5, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 8, "useful_dish_drop_agent_1_mean": 1.911764705882353, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 9, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.9117647058823529, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7647058823529411, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9117647058823529, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7647058823529411, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664, 8.988480000000001, 2.99616, 8.98704, 8.98704, 2.9951999999999996, 5.990399999999999, 5.98944, 11.97888, 0.0, 0.0, 0.0, 8.98128, 2.99328, 5.98656, 17.956799999999998, 5.9856, 0.0, 2.99232], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0, 2.99616, 5.99232, 2.99616, 0.0, 5.99136, 2.99568, 2.99568, 5.99136, 0.0, 2.9951999999999996, 0.0, 5.990399999999999, 2.99472, 2.99472, 8.98416, 2.99472, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.98128, 0.0, 2.99328, 0.0, 5.98656, 0.0, 5.9856, 11.9712, 5.9856, 0.0, 0.0, 0.0, 0.0, 2.99232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4832502573895792, "mean_inference_ms": 0.7305286157674615, "mean_action_processing_ms": 0.07242856490982785, "mean_env_wait_ms": 0.412227544237157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 17.956799999999998, "episode_reward_min": 0.0, "episode_reward_mean": 5.551538823529412, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.99616}, "policy_reward_mean": {"ppo": 2.7757694117647063}, "hist_stats": {"episode_reward": [0.0, 0.0, 5.99904, 2.99952, 8.997119999999999, 11.99616, 2.99856, 8.99568, 0.0, 2.99808, 5.9952, 8.992799999999999, 8.99136, 2.9971200000000002, 11.98656, 2.99664, 8.988480000000001, 2.99616, 8.98704, 8.98704, 2.9951999999999996, 5.990399999999999, 5.98944, 11.97888, 0.0, 0.0, 0.0, 8.98128, 2.99328, 5.98656, 17.956799999999998, 5.9856, 0.0, 2.99232], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.99904, 0.0, 2.99952, 8.997119999999999, 0.0, 11.99616, 0.0, 0.0, 2.99856, 2.99856, 5.99712, 0.0, 0.0, 0.0, 2.99808, 2.9976, 2.9976, 8.992799999999999, 0.0, 2.9971200000000002, 5.9942400000000005, 0.0, 2.9971200000000002, 5.99328, 5.99328, 2.99664, 0.0, 2.99616, 5.99232, 2.99616, 0.0, 5.99136, 2.99568, 2.99568, 5.99136, 0.0, 2.9951999999999996, 0.0, 5.990399999999999, 2.99472, 2.99472, 8.98416, 2.99472, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.98128, 0.0, 2.99328, 0.0, 5.98656, 0.0, 5.9856, 11.9712, 5.9856, 0.0, 0.0, 0.0, 0.0, 2.99232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4832502573895792, "mean_inference_ms": 0.7305286157674615, "mean_action_processing_ms": 0.07242856490982785, "mean_env_wait_ms": 0.412227544237157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 27200, "num_agent_steps_trained": 27200, "num_env_steps_sampled": 13600, "num_env_steps_trained": 13600, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 13600, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 27200, "timers": {"training_iteration_time_ms": 816.789, "learn_time_ms": 102.787, "learn_throughput": 7783.099, "synch_weights_time_ms": 2.596}, "counters": {"num_env_steps_sampled": 13600, "num_env_steps_trained": 13600, "num_agent_steps_sampled": 27200, "num_agent_steps_trained": 27200}, "done": false, "episodes_total": 34, "training_iteration": 17, "trial_id": "default", "experiment_id": "fccb36c3133749cb981cab189ff2c427", "date": "2023-06-17_14-01-21", "timestamp": 1687003281, "time_this_iter_s": 1.5097286701202393, "time_total_s": 25.206749200820923, "pid": 4612, "hostname": "LAPTOP-TER6F2CR", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": 5000000, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "coordination_ring", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": true}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.975, "lr": 0.00016, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 1, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F0210DA48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.156, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.00933, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.069, "vf_clip_param": 10.0, "grad_clip": 0.359, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.5, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x0000018F620ADC48>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x0000018F6196B678>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x0000018F619D2DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 25.206749200820923, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 8.835330724716187, "perf": {"cpu_util_percent": 2.2666666666666666, "ram_util_percent": 46.13333333333333}}
